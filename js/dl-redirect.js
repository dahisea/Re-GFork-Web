window.onload=function(){const a='https://static-sg-apse1-primary-mirror-aws-s3-cloudfront-public-cdn.dahi.edu.eu.org.cdn.cloudflare.net/',
b=document.getElementById('redirect-container'),{hash:c,search:d}=window.location;if(c==="#google_vignette")return showError("連結已失效","此連結已過期或不可用");const e=extractValidUrl(c);if(!e)return showWaiting(c);const f=e.replace('https://update.greasyfork.org.cn/',a);f.startsWith(a)?handleRedirect(f+d):showError("安全限制",`僅允許跳轉至 ${a} 的連結`)};
function renderCard(a,{title:b,message:c,url:d,showReload:e=!0}){const f={waiting:'fa-sync-alt icon-spin',error:'fa-exclamation-triangle',success:'fa-check-circle'};return`<div class="status-card ${a}"><div class="icon ${'waiting'===a?'icon-spin':''}"><i class="fas ${f[a]}"></i></div><h2>${b}</h2><p>${c}</p>${d?`<div class="url-display"><i class="fas fa-link"></i><span>${d}</span></div><div class="actions"><a href="${d}" class="btn" rel="noopener noreferrer"><i class="fas fa-external-link-alt"></i>${'success'===a?'立即':'手動'}前往</a></div>`:''}${'error'===a&&e?`<div class="actions"><button onclick="location.reload()" class="btn"><i class="fas fa-sync-alt"></i>重新載入</button><button onclick="history.back()" class="btn outline"><i class="fas fa-arrow-left"></i>返回上一頁</button></div><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-3758644447684310" data-ad-slot="4095096984" data-ad-format="auto" data-full-width-responsive="true"></ins><script>(adsbygoogle=window.adsbygoogle || []).push({});</script>`:''}${'waiting'===a?`<div class="tips"><i class="fas fa-lightbulb"></i>提示：若長時間停留在此頁面，請重新進入安裝頁</div>`:''}</div>`}
function extractValidUrl(a){return a&&(a.startsWith("#http://")||a.startsWith("#https://"))?a.substring(1):null}
function autoRefresh(a=5){setTimeout(()=>location.reload(),1e3*a)}
function handleRedirect(a){document.getElementById('redirect-container').innerHTML=renderCard('success',{title:'安全驗證通過',message:'即將為您自動跳轉至安全連結',url:a});const b=document.createElement("meta");b.httpEquiv="refresh",b.content=`0; url=${a}`,document.head.appendChild(b)}
function showError(a,b){document.getElementById('redirect-container').innerHTML=renderCard('error',{title:a,message:b})}
function showWaiting(a){const b=extractValidUrl(a);document.getElementById('redirect-container').innerHTML=renderCard('waiting',{title:'正在等待有效連結',message:'系統正在自動檢查中，請稍候...',url:b}),autoRefresh()}